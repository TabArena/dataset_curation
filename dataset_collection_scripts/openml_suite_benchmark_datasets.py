import openml

"""All dids in our sheet"""
existing_dids = numbers = [
    # From TabRepo metadata
    2, 6, 11, 15, 24, 26, 28, 30, 32, 37, 42, 44, 46, 50, 60, 151, 155, 181, 182, 184,
    185, 279, 57, 307, 300, 310, 311, 333, 334, 335, 375, 377, 451, 458, 469, 470, 554,
    715, 717, 725, 727, 728, 734, 735, 740, 742, 750, 752, 757, 761, 770, 799, 802, 803,
    807, 816, 819, 823, 825, 833, 837, 839, 841, 847, 871, 881, 884, 886, 897, 901, 903,
    920, 923, 930, 936, 937, 940, 947, 949, 950, 951, 981, 1039, 1044, 1046, 1050, 1053,
    1056, 1063, 1068, 1069, 1111, 1116, 1120, 1128, 1130, 1134, 1142, 1146, 1161, 1166,
    1233, 1596, 1549, 1553, 1552, 1547, 1542, 1538, 1541, 1528, 1529, 1530, 1531, 1532,
    1535, 1536, 1507, 1509, 1510, 1491, 1496, 1497, 1501, 1502, 1503, 1479, 1480, 1481,
    1483, 1485, 1466, 1471, 1457, 1462, 4552, 6332, 1459, 23380, 1478, 23381, 40496, 40499,
    40536, 40966, 40971, 40981, 40994, 40983, 40985, 23517, 40923, 40927, 41021, 41082,
    41084, 1489, 31, 40982, 41138, 41163, 41164, 41143, 1169, 41167, 41147, 41671, 41158,
    1487, 54, 41144, 41145, 41156, 41157, 41991, 41168, 41989, 4541, 42225, 42571, 4549,
    42572, 42570, 42705, 42728, 550, 546, 541, 507, 505, 287, 216, 41540, 42688, 422, 416,
    42724, 42727, 42729, 42726, 42730, 201, 41980, 42731, 531, 42563, 574, 1515, 188, 1464,
    1494, 1468, 1049, 23, 40975, 12, 1067, 40984, 40670, 3, 40978, 4134, 40701, 1475, 4538,
    4534, 41146, 41142, 40498, 40900, 40996, 40668, 4135, 1486, 41027, 1461, 1590, 41169,
    41166, 41165, 40685, 41159, 41161, 41150, 41162, 42733, 42734, 42732, 42746, 42742,
    42769, 41972, 3050, 3277, 43071, 43072, 41160, 41990, 41988, 41986, 41982, 42193,
    42343, 42345, 40645, 40646, 40647, 40648, 40649, 40650, 40680, 40693, 40704, 40705,
    40706, 40922, 40672, 40677, 40691,
    # From first set of missing dids
    14, 16, 18, 40979, 22, 44957, 29, 44958, 44960, 44959, 44962, 44963, 44964, 44965, 38,
    44966, 44967, 44969, 44970, 44971, 44972, 44973, 44974, 44975, 44976, 44956, 44977,
    44978, 44979, 44980, 44981, 44983, 44984, 44987, 44989, 44990, 44992, 44993, 44994,
    45012, 45402
]

dataset_ids = []
for suite in [
    99, # OpenML-CC18
    353, # OpenML-CTR23
    271, # AMLB Classification,
    269, # AMLB Regression
]:
    # Load the suite by ID
    benchmark_suite = openml.study.get_suite(suite)

    # Get all dataset IDs from the suite
    dataset_ids.extend(benchmark_suite.data)

missing_dids = set(dataset_ids) - set(existing_dids)
print(f"Missing DIDs ({len(missing_dids)}):")
print(list(missing_dids))

for did in missing_dids:
    print(f"https://www.openml.org/search?type=data&sort=runs&status=active&id={did}")